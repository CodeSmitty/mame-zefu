<div id="<%= dom_id recipe %>">
  <div class="flex flex-col shadow-lg w-full lg:min-w-min lg:w-8/12 mx-auto p-0 lg:p-8">
    <div class="flex flex-col lg:flex-row gap-6 mx-auto w-full break-words">
      <div class="w-full">
        <% if recipe.image.attached? %>
          <div style="background-image: url('<%= url_for(recipe.image) %>'); background-size: cover; background-position: center;" class="relative h-100 flex flex-col justify-end mb-4" itemprop="image">
        <% else %>
          <div style="background-image: url('<%= asset_path('placeholder.jpg') %>'); background-size: cover; background-position: center;" class="relative h-100 flex flex-col justify-end mb-4">
        <% end %>
          <h1 class="flex flex-row flex-wrap lg:flex-nowrap text-white bg-black/70 py-2">
            <strong class="text-2xl font-small w-full" itemprop="name"><%= recipe.name %></strong>
            <span class="mr-0 md:mr-10 w-1/3">
              <button
                type="button"
                class="btn btn-xs text-black hover:cursor-pointer"
                data-controller="toggle-favorite"
                data-toggle-favorite-target="button"
                data-toggle-favorite-url-value="<%= toggle_favorite_recipe_path(recipe) %>"
                data-toggle-favorite-is-favorite-value="<%= recipe.is_favorite %>"
                data-toggle-favorite-heart-value='<%= render_icon "mini/heart", classes: "text-rose-600" %>'
                data-toggle-favorite-empty-heart-value='<%= render_icon "mini/empty_heart", classes: "text-rose-600" %>'>
              </button>
            </span>
            <span class="w-1/3">
              <% if recipe.source.present? %>
                <%= link_to recipe.source, target: "_blank", rel: "noopener" do %>
                  <%= render_icon "mini/link" %>
                <% end %>
              <% end %>
            </span>
            <% if recipe.rating.present? %>
              <div class="mb-2 flex flex-row flex-nowrap w-1/3">
                <div class="flex flex-row">
                  <% recipe.rating.to_i.times do %>
                    <%= render_icon "mini/star", classes: "text-yellow-300" %>
                  <% end %>
                </div>
              </div>
            <% end %>
          </h1>
        </div>
          <div class="flex lg:flex-row flex-col flex-nowrap w-full gap-0 lg:gap-4 text-lg pl-2">
            <%= render partial: "recipes/helpers/prep", locals: { itemprop: "recipeYield", label: "Yield", value: recipe.yield } %>
            <%= render partial: "recipes/helpers/prep", locals: { itemprop: "prepTime", label: "Prep Time", value: recipe.prep_time } %>
            <%= render partial: "recipes/helpers/prep", locals: { itemprop: "cookTime", label: "Cook Time", value: recipe.cook_time } %>
          </div>
        <div class="flex flex-row flex-wrap justify-start p-4">
          <% recipe.category_names.sort_by(&:downcase).each do |category| %>
            <div class="py-1">
              <p class="bg-yellow-50 text-input-label text-xs font-semibold me-2 px-2.5 py-0.5 rounded-full border border-input-label" itemprop="recipeCategory"><%= category %></p>
            </div>
          <% end %>
        </div>
        <% if recipe.description.present? %>
          <div class="p-4 lg:p-2">
            <div class="my-5" itemprop="description">
              <%= simple_format(recipe.description) %>
            </div>
          </div>
        <% end %>
        <div class="mx-auto">
          <p class="my-5 p-3">
            <strong class="block font-small mb-1">Ingredients</strong>
          </p>
          <% if recipe.ingredients.present? %>
            <% recipe.ingredients.split(/\n{2,}/).each do |list| %>
              <div class="mb-3 p-4">
                <ul data-controller="list" class="mb-3">
                  <% list.split("\n").each do |item| %>
                    <li data-action="click->list#strike" class="break-words w-full lg:w-[40%] min-w-0 my-3" itemprop="recipeIngredient"><%= item %></li>
                  <% end %>
                </ul>
              </div>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
      <div class="w-full lg:w-3/4 flex flex-col text-lg p-5">
        <p class="my-5">
          <strong class="block font-small mb-1">Directions</strong>
        </p>
        <% if recipe.directions.present? %>
          <% recipe.directions.split(/\n{3,}/).each do |list| %>
            <ol data-controller="list" class="mb-3" itemprop="recipeInstructions">
              <% list.split("\n\n").each do |item| %>
                <li data-list-target="item" data-action="click->list#focus" class="mb-3"><%= item %></li>
              <% end %>
            </ol>
          <% end %>
        <% end %>
        <% if recipe.notes.present? %>
          <p class="my-5">
            <strong class="block font-small mb-1">Notes</strong>
          </p>
          <div class="mb-3">
            <% recipe.notes.split(/\n{2,}/).each do |note| %>
              <p class="mb-3">
                <%= note %>
              </p>
            <% end %>
          </div>
        <% end %>
      </div>
  </div>
</div>
